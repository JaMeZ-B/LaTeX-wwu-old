\section{Summen von zwei Quadraten in $\ZZ$ und der Gaußsche Zahlring $\ZZ[i]$}
\label{sec:para5}
	Ausgangspunkt ist F\ref{F3.8}:	\marginnote{02.12. \\ \ [15]}
	\[ p \kon 1 \modu 4 \quad \Rightarrow \quad \exists c \in \ZZ \text{ mit } c^2 \kon -1 \modu p, \]
	d.h. $c^2 + 1 = kp$ mit einem $k \in \ZZ$.
	
\begin{satz}[Fermat, Euler] \label{satz_5.1}
	Sei $p$ eine Primzahl. Ist $p \kon 1 \modu 4$, so gibt es $x,y \in \ZZ$ mit
	\begin{equation}
		p = x^2 + y^2 \label{eq_5.1}
	\end{equation}
	Ist umgekehrt $p$ in der Gestalt \eqref{eq_5.1} darstellbar, so ist $p \kon 1 \modu 4$ oder $p = 2$.
\end{satz}

\begin{defn}[Gaußscher Zahlring]
	\[ \ZZ[i] := \{a + bi : a,b \in \ZZ\} \]	
	heißt \Index{Gaußscher Zahlring}. Es ist $\ZZ[i]^\times = \{1, -1, i, -i\}$ und $(a+bi)(a-bi) = a^2+b^2$.
\end{defn}

\begin{satz}[Gaußscher Zahlring ist euklidisch] \label{satz_5.2}
	$\ZZ[i]$ ist ein euklidischer Ring mit euklidischer Normfunktion $\nu$ definiert durch \index{euklidischer Ring}
	\[ \nu(z) = z \cdot \overline{z} =: N(z), z \in \ZZ[i] \]
\end{satz}

\begin{falko} \label{F5.1}
	Sei $\pi$ ein Primelement $\neq 0$ von $\ZZ[i]$. Dann gibt es genau eine Primzahl $p$ mit $\pi | p$ in $\ZZ[i]$. Es gilt entweder $N(\pi)=p$ oder $N(\pi)=p^2$. Im ersten Fall nennen wir $\pi$ vom Grad 1, im zweiten Fall vom Grad 2.
\end{falko}

Um alle Primelemente $\pi$ von $\ZZ[i]$ zu finden, haben wir also die Primfaktorzerlegung aller $p \in \ZZ[i]$ zu untersuchen. Die $p$ heißen \bet{rationale Primzahlen}, die $\pi$ \bet{Gaußsche Primzahlen}. \index{rationale Primzahl} \index{Gaußsche Primzahl}

\begin{satz} \label{satz_5.3}
	Sei $p$ Primzahl sowie $\pi$ ein Primfaktor von $p$ in $\ZZ[i]$. Dann gibt es drei Fälle: \begin{enumerate}[(i)]
		\item $p \assoz \pi^2$ \quad ($p$ ist \bet{verzweigt} in $\ZZ[i]$)
		\item $p \assoz \pi$ \quad ($p$ ist \bet{träge} in $\ZZ[i]$, d.h. $p$ bleibt Primelement in $\ZZ[i]$)
		\item $p = \pi \overline{\pi}$ mit $pi \not \assoz \overline{\pi}$ \quad ($p$ \bet{zerfällt} in $\ZZ[i]$)
	\end{enumerate}
	Und zwar gilt: \index{Verzweigtheit} \index{Trägheit}
	\[\begin{array}{rclcl}
		\text{(i)} & \Leftrightarrow &  p = 2 &  & \\ 
		\text{(ii)} & \Leftrightarrow  & N(\pi) = p^2 & \Leftrightarrow &  p \kon 3 \modu 4 \\ 
		\text{(iii)} & \Leftrightarrow & N(\pi) = p & \Leftrightarrow &  p \kon 1 \modu 4 \\ 
	\end{array}\]
	Also ist z.B. $7$ auch in $\ZZ[i]$ ein Primelement, aber $5 = (2+i)(2-i)$ nicht.	
\end{satz}

\minisec{Korollar}
	Ist $p$ eine Primzahl mit $p \kon 1 \modu 4$, so ist $p$ in der Gestalt $p = a^2 + b^2$ mit $a,b \in \NN$ darstellbar. Bis auf Vertauschung von $a$ und $b$ ist diese Darstellung eindeutig. Ferner ist notwendigerweise $(a,b) = 1$.
	
\begin{satz} \label{satz_5.4}
	Sei $n \in \NN$. \begin{enumerate}[(i)]
		\item Genau dann ist $n$ eine Summe von zwei Quadraten in $\ZZ$, wenn für jede Primzahl $p \kon 3 \modu 4$ der Exponent $w_p(n)$ gerade ist.
		\item Besitzt $n$ eine primitive Darstellung als Summe von zwei Quadraten, d.h.
		\begin{equation}
			n = a^2 + b^2 \text{ mit teilerfremden } a,b \in \ZZ, \label{eq_satz_5.4_1}
		\end{equation}
		so folgt:
		\begin{equation}
			n \text{ hat keine Primteiler } p \kon 3 \modu 4, \text{ und es ist } 4 \not | \ n. \label{eq_satz_5.4_2}
		\end{equation}
		\item Umgekehrt: Gelte \eqref{eq_satz_5.4_2}, und bezeichne $s$ die Anzahl der ungeraden Primteiler von $n$. Für $n > 2$ hat dann $n$ genau $2^{s-1}$ primitive Darstellungen als Summe von zwei Quadraten, wenn nur wesentlich verschiedene Darstellungen gezählt werden. \\
		(Beachte: $n$ kann außerdem noch nicht-primitive Darstellungen haben, z.B. $50 = 7^2 + 1^2 = 5^2 + 5^2$.)
	\end{enumerate}
\end{satz}

\minisec{Korollar}
	Es sei $n$ \marginnote{05.12. \\ \ [16]} eine ungerade natürliche Zahl, $n > 1$. Besitzt $n$ im Wesentlichen nur eine einzige Darstellung als Summe von zwei Quadraten und ist diese Darstellung primitiv, so ist $n$ eine Primzahl (Umkehrung des Korollars von Satz \ref{satz_5.3}).
	
\minisec{Bemerkung}
	$45 = 6^2 + 3^2$ ist die einzige Darstellung von $45$ als Summe von zwei Quadraten, doch diese ist nicht primitiv. \\
	Im Übrigen ist die Voraussetzung, dass $n$ ungerade ist, wesentlich: Für $n = 10$ ist $10 = 3^2 + 1^2$ die im Wesentlichen einzige Darstellung von $10$ als Summe von zwei Quadraten und diese ist auch primitiv.
	
\subsection{Pythagoräische Tripel}
	\begin{equation}
		X^2 + Y^2 = Z^2 \label{eq_pyth_tripel}
	\end{equation}
	Eine Lösung $(a,b,c) \in \NN^3$ von \eqref{eq_pyth_tripel} heißt \Index{pythagoräisches Tripel}.\marginnote{16.12. \\ \ [18]} Wenn $\ggT(a,b,c) = 1$, heißt es \bet{primitiv}. Es genügt, primitive pythagoräische Tripel zu betrachten.
	
\begin{falko} \label{F5.2}
	Die Menge der primitiven pythagoräischen Tripel $(a,b,c)$, bei denen ohne Einschränkung $b$ gerade ist, wird geliefert durch:
	\begin{equation}
		\penbrace{ (u^2-v^2,2uv,u^2+v^2) \in \NN^3 : u,v \in \NN, \ggT(u,v) = 1, uv \text{ gerade, } u>v } \label{eq_pyth_tripel2}
	\end{equation}
\end{falko}

\begin{falko}
	Die Gleichung $X^4+Y^4 = Z^2$ besitzt keine Lösung $(a,b,c) \in \NN^3$. (In $\ZZ^3$ hat sie gewisse triviale Lösungen: $(0, \pm b, b^2), (\pm a, 0, a^2)$.)
\end{falko}

\minisec{Folgerung}
	Die Gleichung $X^4+Y^4=Z^4$ hat keine Lösung in $\NN^3$. (Fermat-Vermutung für den Exponenten $4$).
	
\subsection{Pythagoräische Quadrupel}
	Wir fragen nach allen Quadern mit ganzzaligen Kantenlängen $a,b,c > 0$, deren Raumdiagonale ebenfalls ganzzahlige Länge $d > 0$ hat. Wir suchen also nach allen Quadrupeln $(a,b,c,d) \in \NN^4$ mit
	\begin{equation}
		d^2 = a^2+b^2+c^2, \label{eq_pyth_quadr_1}
	\end{equation}
	und zwar ohne Einschränkungen nur nach primitiven, d.h. solchen mit $\ggT(a,b,c,d) = 1$, was gleichbedeutend mit $\ggT(a,b,c) = 1$ ist. Von den Zahlen $a,b,c$ kann höchstens eine ungerade sein, denn sonst ist $d^2 \kon 2 \modu 4$ oder $d^2 \kon 3 \modu 4$. Wegen $\ggT(a,b,c) = 1$ sind $a,b,c$ nicht alle gerade. Wir setzen dabei ohne Einschränkung voraus, dass $a$ ungerade ist, aber $b,c$ gerade sind. Nach \eqref{eq_pyth_quadr_1} ist $d$ ungerade, also sind $a+d$ und $a-d$ gerade. Daher schreibe \eqref{eq_pyth_quadr_1} in der Form:
	\begin{equation}
		\frac{d+a}{2} \frac{d-a}{2} = \frac{b^2+c^2}{4} = \enbrace*{\frac{b}{2}}^2 + \enbrace*{\frac{c}{2}}^2 \label{eq_pyth_quadr_2}
	\end{equation}
	Es liegt also nahe, nach einer Zerlegung
	\begin{equation}
		\frac{b}{2} + i \frac{c}{2} = (p+qi)(u+vi) \label{eq_pyth_quadr_3}
	\end{equation}
	in $\ZZ[i]$ zu suchen, die bei Normbildung in \eqref{eq_pyth_quadr_2} übergeht, die also
	\begin{equation}
		N(P+qi) = \frac{d+a}{2} \quad \text{und} \quad N(u+iv) = \frac{d-a}{2} \label{eq_pyth_quadr_4}
	\end{equation}
	erfüllt, d.h. $\frac{d+a}{2} = p^2 + q^2$ und $\frac{d-a}{2} = u^2+v^2$, mithin
	\begin{equation}
		d = p^2 + q^2 + u^2 + v^2 \quad a = p^2+q^2-u^2-v^2 \label{eq_pyth_quadr_5}.
	\end{equation}
	Wegen $(p+qi)(u+iv) = (pu-qv) + (qu+pv)i$ ist andererseits \eqref{eq_pyth_quadr_3} äquivalent mit
	\begin{equation}
		b = 2(pu-qv) \quad c = 2qu + pv. \label{eq_pyth_quadr_6}
	\end{equation}
	Um zu einer Zerlegung \eqref{eq_pyth_quadr_3}, die \eqref{eq_pyth_quadr_4} erfüllt, zu gelangen, gehen wir von der Primfaktorzerlegung von $\frac{b}{2} + i \frac{c}{2}$ in $\ZZ[i]$ aus. Diese notieren wir in der Gestalt
	\begin{equation}
		\frac{b}{2} + i \frac{c}{2} = \varepsilon n \pi_1^{\nu_1} \overline{\pi_1}^{\nu_1'} \cdots \pi_r^{\nu_r} \overline{\pi_r}^{\nu_r'} \pi_{r+1}^{\nu_{r+1}} \cdots \pi_s^{\nu_s}, \label{eq_pyth_quadr_7}
	\end{equation}
	wobei wir in $n$ alle Primfaktoren zusammenfassen, die zu Primzahlen $q \kon 3 \modu 4$ gehören, während zu jedem der Primelemente $\pi_i$ Primzahlen $p_i = N(\pi_i) = \pi_i \overline{\pi_i}$ mit $p_i \kon 1 \modu 4$ oder $p_i = 2$ gehören; im letzteren Fall ist $\overline{\pi_i} \assoz \pi_i \assoz 1+i$, während für $p_i \neq 2$ stets $\overline{\pi_i} \not\assoz \pi_i$ gilt. Die $\pi_i$ mit $1 \leq i \leq r$ bezeichnen genau die Primteiler $\pi_i$ mit $\overline{\pi_i} \not\assoz \pi_i$, für die auch $\overline{\pi_i}$ in $\frac{b}{2} + i \frac{c}{2}$ aufgeht. Per Normbildung geht \eqref{eq_pyth_quadr_7} über in
	\begin{equation}
		\enbrace*{\frac{b}{2}}^2 + \enbrace*{\frac{c}{2}}^2 = n^2 p_1^{\nu_1 + \nu_1'} \cdots p_r^{\nu_r + \nu_r'} p_{r+1}^{\nu_{r+1}} \cdots p_s^{\nu_s} \label{eq_pyth_quadr_8}
	\end{equation}

\begin{lemma}
	Jede Primzahl $q \kon 3 \modu 4$ geht in $d+a$ bzw. $d-a$ mit gerader Vielfachheit auf.
\end{lemma}

	Nach dem Lemma haben die Faktoren $\frac{d+a}{2}$ und $\frac{d-a}{2}$ in \eqref{eq_pyth_quadr_2} mit Blick auf \eqref{eq_pyth_quadr_8} die Darstellungen
	\begin{equation}
		\begin{array}{c}
			\frac{d+a}{2} = n_1^2 p_1^{\lambda_1} \cdots p_s^{\lambda_s} \quad \frac{d-a}{2} = n_2^2 p_1^{\mu_1} \cdots p_s^{\mu_s} \\
			\text{ mit } n_1,n_2 \in \NN, \lambda_i,\mu_i \geq 0 \text{ und } \lambda_i + \mu_i = \nu_i + \nu_i' \text{ für } 1 \leq i \leq r, \label{eq_pyth_quadr_9} \\
			\lambda_i + \mu_i = \nu_i \text{ für } r+1 \leq i \leq s; n_1 n_2 = n
		\end{array}
	\end{equation}
	Ausschlaggebend ist nun die folgende Feststellung: Für $1 \leq i \leq r$ geht $p_i$ nicht in beiden der Zahlen $\frac{d+a}{2}, \frac{d-a}{2}$ auf. Denn sonst wäre $p_i$ ein Teiler von $a$ und $d$, andererseits geht $p_i = \pi_i \overline{\pi_i}$ nach \eqref{eq_pyth_quadr_7} in $b$ und $c$ auf, im Widerspruch zu $\ggT(a,b,c)=1$. Unter den $p_i$ mit $1 \leq i \leq r$ bezeichnen nun ohne Einschränkung $p_1, \dots, p_m$ genau die $p_i$, die in $\frac{d+a}{2}$ aufgehen. Dann gilt in \eqref{eq_pyth_quadr_9} genauer:
	\begin{equation}
		\begin{array}{c}
			\frac{d+a}{2} = n_1^2 p_1^{\nu_1 + \nu_1'} \cdots p_m^{\nu_m + \nu_m'} p_{r+1}^{\lambda_{r+1}} \cdots p_s^{\lambda_s} \\
			\frac{d-a}{2} = n_2^2 p_{m+1}^{\nu_{m+1} + \nu_{m+1}'} \cdots p_r^{\nu_r + \nu_r'} p_{r+1}^{\mu_{r+1}} \cdots p_s^{\mu_s} \label{eq_pyth_quadr_10} \\
			\text{ mit } n_1 n_2 = n; \lambda_i, \mu_i \geq 0 \text{ und } \lambda_i + \mu_i = \nu_i \text{ für } r+1 \leq i \leq s
		\end{array}
	\end{equation}
	Setzen wir nun
	\begin{equation}
		\begin{array}{c}
			p+qi := \varepsilon n_1 \pi_1^{\nu_1} \overline{\pi_1}^{\nu_1'} \cdots \pi_m^{\nu_m} \overline{\pi_m}^{\nu_m'} \pi_{r+1}^{\lambda_{r+1}} \cdots \pi_s^{\nu_s} \\
			u+vi := n_2 \pi_{m+1}^{\nu_{m+1}} \overline{\pi_{m+1}}^{\nu_{m+1}'} \cdots \pi_r^{\nu_r} \overline{\pi_r}^{\nu_r'} \pi_{r+1}^{\mu_{r+1}} \cdots \pi_s^{\nu_s}
		\end{array}		
	\end{equation}
	(mit derselben Einheit $\varepsilon$ wie in \eqref{eq_pyth_quadr_7}), so sind in der Tat \eqref{eq_pyth_quadr_3} wie \eqref{eq_pyth_quadr_4} erfüllt, vgl. \eqref{eq_pyth_quadr_7}. Im übrigen erhält man auch folgende Eindeutigkeitsaussage:
	$p+qi, u+vi$ in \eqref{eq_pyth_quadr_3} lassen sich nur durch $\varepsilon_1(p+qi), \varepsilon_2(u+iv)$ mit Einheiten $\varepsilon_1, \varepsilon_2$ ersetzen, die $\varepsilon_1 \varepsilon_2 = 1$ erfüllen. Mit einem Parameter-Quadrupel $(p,q,u,v)$ sind so auch $(-p,-q,-u,-v), (-q,p,v,-u), (q,-p,-v,u)$ zulässige Quadrupel von Parametern, aber keine weiteren.
	
\minisec{Bemerkung 1}
	Für ein Parameter-Quadrupel zu $a,b,c,d$ muss offenbar gelten:
	\begin{equation}
		\begin{array}{c}
			p^2+q^2 > u^2+v^2 > 0 \quad pu - qv > 0 \quad qu+pv > 0 \quad \ggT(p,q,u,v)=1 \text{ und} \\
			\text{von den Parametern } p,q,u,v \text{ ist genau einer ungerade oder genau einer gerade.} \label{eq_pyth_quadr_12}
		\end{array}
	\end{equation}
	
\minisec{Bemerkung 2}
	Für jedes Quadrupel $(p,q,u,v) \in \ZZ^4$ mit \eqref{eq_pyth_quadr_12} liefern die Formeln \eqref{eq_pyth_quadr_5} und \eqref{eq_pyth_quadr_6} ein Quadrupel $(a,b,c,d) \in \NN^4$ mit $a^2+b^2+c^2 = d^2$. (Allerdings ist $(a,b,c,d)$ nicht notwendig primitiv, vgl. weiter unten.)
	
\minisec{Bemerkung 3}
	Für $(4,7,2,-1)$ und $(8,1,2,1)$ liefern \eqref{eq_pyth_quadr_5} und \eqref{eq_pyth_quadr_6} das gleiche Quadrupel $(a,b,c,d) = (60,30,20,70)$. Aber dieses ist nicht primitiv und man hat keinen Widerspruch zur obigen Eindeutigkeitsaussage. Außerdem verletzen diese Quadrupel die Paritätsbedingung in \eqref{eq_pyth_quadr_12}.
	
\minisec{Bemerkung 4}
	Die Quadrupel $(1,13,2,-1)$ und $(11,7,2,1)$ erfüllen jeweils alle Bedingungen in \eqref{eq_pyth_quadr_12}. Sie liefern das gleiche Quader-Quadrupel $(a,b,c,d) = (165, 30, 50, 175)$, aber dieses ist nicht primitiv. Kann es auch nicht sein, denn sonst widerspräche das der obigen Eindeutigkeitsaussage.
	
\minisec{Frage}
	Kann man \eqref{eq_pyth_quadr_12} so ergänzen, dass $(p,q,u,v)$ eine primitive Lösung $(a,b,c,d)$ liefert?
\newpage