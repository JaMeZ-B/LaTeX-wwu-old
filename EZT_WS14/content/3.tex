\section{Kongruenzrechnung}
\label{sec:para3}
	Zur Motivation:
	
\begin{satz}[Fermats kleiner Satz] \label{satz_3.1}
	Sei $p$ Primzahl. Für jede ganze Zahl mit $p \not | \ a$ gilt dann:
	\[ p | a^{p-1} - 1, \]
	d.h. $a^{p-1}$ lässt bei der Division durch $p$ stets den Rest 1. \index{Fermats kleiner Satz}
\end{satz}

\begin{defn}[Kongruenz in $\ZZ$] \label{def_3.1}
	Sei $m \in \NN$ fest. Für $x\in \ZZ$ sei $r_m(x)$ der eindeutige nichtnegative Rest von $x$ bei der Division von $x$ durch $m$. \marginnote{11.11. \\ \ [9]}
	\[ x = qm + r_m \quad 0 \leq r < m \]
	Wir definieren eine Relation
	\[ x \underset{m}{\sim} x' \qquad :\Leftrightarrow \qquad r_m(x) = r_m(x') \marginnote{Gleichheit bzgl. $m$}\]
	Statt $x \underset{m}{\sim} x'$ schreibt man nach Gauß:
	\[ x \equiv x' \modu m \]
	und sagt: $x$ ist kongruent zu $x'$ modulo $m$. \index{Kongruenz}
\end{defn}

\begin{falko} \label{F3.1} 
	\[ x \equiv x' \modu m \quad \Leftrightarrow \quad m | x-x' \]	
\end{falko}

\setcounter{countdef}{0}
\begin{defn}[Kongruenz allgemeiner] \label{def_3.1a}
	Sei $R$ ein kommutativer Ring und $m \in R$. Definiere:
	\[ x \equiv y \modu m :\Leftrightarrow m | x-y \]
	$x \equiv y \modu 0 \Rightarrow x=y$ \\
	$x \equiv y \modu 1$ gilt für alle $x,y \in R$. \\
	$x \equiv 0 \modu m \Leftrightarrow m | x$
\end{defn}

\begin{falko} \label{F3.2}
	\begin{enumerate}[(i)]
		\item $x \equiv x \modu m, \quad x \equiv y \modu m \Rightarrow y \equiv x \modu m, \quad x \equiv y \modu m, y \equiv z \modu m \Rightarrow x \equiv z \modu m,$ \\
		d.h. $\cdot \equiv \cdot \modu m$ ist eine Äquivalenzrelation auf $R$. Diese ist verträglich mit Addition und Multiplikation:
		\item $x \equiv x' \modu m, y \equiv y' \modu m \quad \Rightarrow x+y \equiv x'+y' \modu m, xy \equiv x'y' \modu m$
		\item $x \equiv y \modu m, m'|m \quad \Rightarrow \quad x \equiv y \modu m'$
		\item Für $R = \ZZ$: \qquad $x \equiv y \modu m_i, 1 \leq i \leq r \quad \Leftrightarrow \quad x \equiv y \modu \kgV(m_1,\dots,m_r)$
		\item $x \equiv y \modu m \quad \Rightarrow \quad cx \kon cy \modu xm \quad \Rightarrow \quad cx \equiv cy \modu m$
		\item Für einen Integritätsring $R$ gilt: $x \equiv y \modu m$ und $l | x, l|m, l \neq 0 \quad \Rightarrow \quad l|y$ und $\frac{x}{l} \equiv \frac{y}{l} \modu \frac{m}{l}$
		\item Für $R = \ZZ$: Ist $\ggT(c,m) = d$ mit $d \neq 0$, so gilt $ac \kon bc \modu m \quad \Rightarrow \quad a \kon b \modu \frac{m}{d} $
		\item $m | ac-bc \quad \Rightarrow \quad m | c(a-b) \quad \Rightarrow \quad \frac{m}{d} | \frac{c}{d}(a-b) \quad \xLongrightarrow{\enbrace*{\frac{m}{d},\frac{c}{d}}=1} \quad \frac{m}{d} | a-b$
	\end{enumerate}
\end{falko}

\begin{defn}[Restklasse] \label{def_3.2}
	Ein $m \in R$ teilt $R$ in disjunkte Mengen ein, die den zugehörigen Äquivalenzklassen entsprechen. Diese heißen die \bet{Restklassen} modulo $m$. \index{Restklasse}
\end{defn}

\begin{falko} \label{F3.3}
	Sei $n \in \NN$ ungerade. Dann:
	\[ (n-1)! \kon 1^2 \cdot 2^2 \dots \enbrace*{\frac{n-1}{2}}^2 \cdot (-1)^{\frac{n-1}{2}} \modu n \]
\end{falko}

\begin{falko} \label{F3.4}
	$a,b,c \in \ZZ$, $d:= (a,b)$. Die Gleichung
	\begin{equation}
		aX + bY = c \label{eq_3.1}
	\end{equation}
	ist genau dann lösbar über $\ZZ$, wenn $d | c$. Sei $d \neq 0$. Ist $(x_0,y_0)$ eine Lösung von \eqref{eq_3.1}, so gehört zu jeder Lösung $(x,y)$ von \eqref{eq_3.1} genau ein $t \in \ZZ$ mit
	\begin{equation}
		x = x_0 + t \frac{b}{d} \qquad y = y_0 - t \frac{a}{d}, \label{eq_3.2}
	\end{equation}
	und jedes $(x,y)$ wie in \eqref{eq_3.2} ist eine Lösung von \eqref{eq_3.1}.
\end{falko}

\begin{falko} \label{F3.5}
	Die Kongruenz
	\begin{equation}
		aX \kon c \modu m \label{eq_3.1a}
	\end{equation}
	ist genau dann lösbar über $\ZZ$, wenn
	\begin{equation}
		(a,m) | c. \label{eq_3.2a}
	\end{equation}
	Sei $d := (a,m) \neq 0$, und es gelte \eqref{eq_3.2a}. Die Lösungsmenge von \eqref{eq_3.1a} ist dann eine Restklasse modulo $\frac{m}{d}$. Die Kongruenz \eqref{eq_3.1a} besitzt genau $d = (a,m)$ viele Lösungen modulo $m$. Insbesondere gilt: Ist $(a,m) = 1$, so ist \eqref{eq_3.1a} für jedes $c$ lösbar und die Lösungen sind modulo $m$ eindeutig. 
\end{falko}

\setcounter{countdef}{1}
\begin{defn}[Restklassen allgemein] \label{def_3.2a}
	Sei $R$ ein kommutativer Ring, $m \in R$. Die \Index{Restklasse} modulo $m$, in der $a \in R$ liegt, hat die Gestalt
	\[ \{x \in R : x \kon a \modu m\} = a+mR = \{a + ym : y \in R\}. \]
	Die Menge aller Restklassen modulo $m$ bezeichnen wir mit $R/mR$, aber auch $R/m$. Der für uns wichtigste Fall ist $R = \ZZ$ und $m \in \NN$.
\end{defn}

\minisec{Beispiel}
	Sei $m \in \NN$. Betrachte
	\[R = \ZZ_{(m)} := \penbrace*{ \frac{b}{a} : a,b \in \ZZ, (a,m) = 1} \subseteq \QQ \]
	Die Inklusionsabbildung $\ZZ \rightarrow \ZZ_{(m)}$ vermittelt einen Ringisomorphismus
	\begin{equation}
		\ZZ/m\ZZ \longrightarrow \ZZ_{(m)}/m\ZZ_{(m)}
	\end{equation}
	
\minisec{Bemerkung}
	Sei $(a,m) = 1$. Wohlverstanden darf man also sagen: \\
	Die Kongruenz $aX \kon c \modu m$ besitzt die Lösung $\frac{c}{a} \modu m$. Es gibt ein $x \in \ZZ$ mit $x \kon \frac{c}{a} \modu m$, und für dieses ist $ax \kon c \modu m$.
	
\minisec{Beispiel}
	Die Kongruenz $7X \kon 1 \modu 123$ ist "eindeutig" lösbar:
	\[ 7x \kon 1 \modu 123 \quad \Rightarrow \quad x \kon \frac{1}{7} = \frac{4}{28} \kon \frac{-119}{28} = \frac{-17}{4} \kon \frac{-140}{4} \kon -35 \modu 123 \]
	Das funktioniert nicht immer so gut, aber allgemein kann man folgendes sagen:
	
\minisec{Bemerkung}
	Zur Lösung der Kongruenz
	\begin{equation}
		aX \kon 1 \modu m \quad \text{mit } (a,m) = 1 \text{ und } a \in \NN \label{eq_3.bem}
	\end{equation}
	Betrachte $\alpha = \frac{m}{a} \in \QQ$ und führe die Kettenbruchentwicklung durch. Diese endet mit $\frac{m}{a} = \frac{c_n}{d_n}$. Dann gilt (vgl. Beispiel nach Satz \ref{satz_2.2}):
	\[ (-1)^n c_{n-1}a - (-1)^n d_{n-1} m = 1 \quad \Rightarrow \quad a(-1)^n c_{n-1} \kon 1 \modu m \]
	Somit ist
	\[ x = (-1)^n c_{n-1} \]
	eine Lösung von \eqref{eq_3.bem}.
	
\begin{falko} \label{F3.6}
	Sei $m \in \NN$. \marginnote{14.11. \\ \ [10]}
	\begin{enumerate}[(i)]
		\item $\ZZ/m\ZZ$ ist auf natürliche Weise ein kommutativer Ring mit Eins ($\neq 0$, falls $m > 1$). Die Restklassenprojektion
		\begin{equation}
		\begin{aligned}
			\ZZ &\longrightarrow \ZZ/m\ZZ \\
			a &\longmapsto \overline{a} = a+m\ZZ =: a \mod m
		\end{aligned}
		\end{equation}
		ist ein Ringhomomorphismus. Für $m > 1$ ist $\ZZ/m\ZZ \rightarrow \ZZ_{(m)}/m\ZZ_{(m)}$ ein Ringisomorphismus, sodass man $\ZZ_{(m)}/m\ZZ_{(m)}$ mit $\ZZ/m\ZZ$ identifizieren kann.
		\item $\ZZ/m\ZZ$ hat genau $m$ Elemente.
		\item Für beliebige $c \in \ZZ$ ist $c, c+1, \dots, c+(m-1)$ ein \Index{Vertretersystem} modulo $m$. \\
		$S \subseteq \ZZ$ heißt ein Vertretersystem modulo $m$ bzw. von $\ZZ/m\ZZ$, wenn gilt: Zu jedem $x \in \ZZ$ existiert genau ein $a \in S$ mit $x \kon a \modu m$. Anders ausgedrückt: Die Einschränkung der Restklassenabbildung $\ZZ \rightarrow \ZZ/m\ZZ$ auf $S$ ist eine Bijektion. Äquivalent dazu ist, dass die Einschränkung injektiv oder surjektiv ist und $|S|=m$.
		\item $\ZZ/m\ZZ$ Integritätsring \quad $\Leftrightarrow$ \quad $\ZZ/m\ZZ$ Körper \quad $\Leftrightarrow$ \quad $m$ Primzahl. \\
		Für eine Primzahl $p$ heißt $\ZZ/p\ZZ$ der \Index{Restklassenkörper} modulo $p$.
		\item $(a,m) = d, x \kon a \modu m \quad \Rightarrow \quad (x,m) = d$
		\item $\overline{a} \in (\ZZ/m\ZZ)^\times \quad \Leftrightarrow \quad (a,m) = 1$. \\
		Die Elemente $\overline{a}$ von $(\ZZ/m\ZZ)^\times$ heißen prime Restklassen modulo $m$.
	\end{enumerate}
\end{falko}

\begin{lemma}
	Sei $R$ ein endlicher kommutativer Ring mit Eins. Dann ist
	\[ R^\times = \penbrace{a \in R : a \text{ ist kein Nullteiler von } R} \]
\end{lemma}

\begin{falko}[Satz von Wilson] \label{F3.7}
	Für $n \in \NN$ gilt: \index{Satz von Wilson}
	\[ n \text{ Primzahl} \quad \Leftrightarrow \quad (n-1)! \kon -1 \modu n \]
\end{falko}

\begin{falko} \label{F3.8}
	Sei $p \neq 2$ Primzahl. Dann ist die Kongruenz
	\[ X^2 \kon -1 \modu p \]
	genau dann lösbar in $\ZZ$, wenn $p \kon 1 \modu 4$, d.h. $p = 1+4k$ für ein $k \in \NN$.
\end{falko}

\minisec{Bemerkungen}
	\begin{enumerate}[1)]
		\item \ref{F3.8} anders formuliert. Setze $\FF_p := \ZZ/p\ZZ$ Körper.
		\[ \sqrt{-1} \in \FF_p \quad \Leftrightarrow \quad p \kon 1 \modu 4 \text{ oder } p = 2 \]
		\item Sei $p \neq 2$ Primzahl. Dann:
		\[ \enbrace*{\frac{p-1}{2}}!^2 \kon \begin{cases}
			-1 \modu p & \text{für } p \kon 1 \modu 4 \\
			1 \modu p & \text{für } p \kon 3 \modu 4
		\end{cases} \]
		Für $p \kon 3 \modu 4$ gilt also $\enbrace*{\frac{p-1}{2}}!^2 \kon \pm 1 \modu p$. Mehr dazu in Abschnitt 6.
	\end{enumerate}
	
\begin{defn}[Eulersche $\varphi$-Funktion]
	Für jede natürliche Zahl $m$ definiere
	\[ \varphi(m) := \#(\ZZ/m\ZZ)^\times \marginnote{$\varphi(1)=1$} \]
	Nach F\ref{F3.6} gilt $\varphi(m) = \# \{a \in \{0, 1, 2, \dots, m-1\} : a \text{ teilerfremd zu } m \}$. Für eine Primzahl $p$ ist daher $\varphi(p) = p-1$. $\varphi$ heißt \Index{Eulersche $\varphi$-Funktion}.
\end{defn}

\setcounter{countsatz}{0}
\begin{satz}[Satz von Euler-Fermat] \label{satz_3.1a}
	Aus $(a,m) = 1$ folgt $a^{\varphi(m)} \kon 1 \modu m$. \index{Satz von Euler-Fermat}
\end{satz}

\begin{lemma}
	Sei $G$ eine abelsche Gruppe der Ordnung $n$. Dann gilt $x^n = 1$ für alle $x \in G$.
\end{lemma}

\subsection{Simultane Kongruenzen}
\begin{satz}[Chinesischer Restsatz] \label{satz_3.2}
	Ist $m = m_1 m_2 \cdot m_r$ mit paarweise teilerfremden natürlichen Zahlen $m_1,\dots,m_r > 1$, so ist die Abbildung \index{Chinesischer Restsatz}
	\begin{equation}
	\begin{aligned}
		\ZZ/m &\longrightarrow \ZZ/m_1 \times \ZZ/m_2 \times \cdots \times \ZZ/m_r \\
		a \modu m &\longmapsto (a \modu m_1, a \modu m_2, \dots, a \modu m_r)	\label{eq_satz_3.2}
	\end{aligned}
	\end{equation}
	
	ein Isomorphismus von Ringen. Ist insbesondere $m = p_1^{e_1} p_2^{e_2} \cdots p_r^{e_r}$ die Primfaktorzerlegung einer natürlichen Zahl $m > 1$, so gilt
	\[ \ZZ/m\ZZ \simeq \ZZ/p_1^{e_1} \times \cdots \times \ZZ/p_r^{e_r} \]
	mit kanonischer Isomorphie. Der Isomorphismus $\eqref{eq_satz_3.2}$ vermittelt einen Isomorphismus
	\[ (\ZZ/m)^\times \simeq (\ZZ/m_1)^\times \times \dots \times (\ZZ/m_r)^\times \]
	der primen Restklassengruppen; insbesondere gilt
	\[ \varphi(m) = \varphi(m_1) \cdot \varphi(m_2) \cdots \varphi(m_r) \]
\end{satz}

\setcounter{countsatz}{1}
\begin{satz}[Chinesischer Restsatz für simultane Kongruenzen] \label{satz_3.2a}
	Sei $m = m_1m_2 \cdots m_r$ mit paarweise teilerfremden natürlichen Zahlen $m_1,\dots,m_r > 1$. Sind dann $a_1,\dots,a_r$ beliebige ganze Zahlen, so gibt es eine ganze Zahl $x$ mit \index{Chinesischer Restsatz} \index{simultane Kongruenz}
	\begin{equation}
	\begin{aligned}
		x &\kon a_1 \modu m_1 \\
		x &\kon a_2 \modu m_2 \\
		&\ \ \vdots \\
		x &\kon a_r \modu m_r \label{eq_satz_3.2a}
	\end{aligned}
	\end{equation}
	Durch \eqref{eq_satz_3.2a} ist $x$ modulo $m$ eindeutig bestimmt, ferner gilt:
	\[ x \text{ prim zu } m \quad \Leftrightarrow \quad a_i \text{ prim zu } m_i \text{ für alle } i \]
\end{satz}

\minisec{Bemerkung}
	Es genügt, sich $x_i$ zu verschaffen mit
	\begin{equation}
		x_1q_1 + x_2q_2 + \dots + x_rq_r \kon 1 \mod m \marginnote{$q_i = \frac{m}{m_i}$} \label{eq_satz_3.2_bem}
	\end{equation}
	Dann wird \eqref{eq_satz_3.2a} erfüllt von
	\[x = a_1(x_1q_1) + \dots + a_r(x_rq_r) \]
	Für jedes $1 \leq i \leq r$ bestimme (notfalls mit Kettenbruchentwicklung) ein $x_i \in \ZZ$ mit
	\[ q_i x_i \kon 1 \modu m_i \marginnote{$(q_i,m_i) =1$} \]
	Dann ist 
	\[ x_1q_1 + \dots + x_rq_r \kon 1 \modu m_i\]
	für alle $1 \leq i \leq r$, und es folgt \eqref{eq_satz_3.2_bem}.
	
\minisec{Korollar}
	Sei $f \in \ZZ[X]$, $m = m_1\cdot m_2 \cdot \dots \cdot m_r$ mit paarweise teilerfremden $m_i > 1$. Dann: \marginnote{18.11. \\ \ [11]}
	\[f(X) \kon 0 \modu m \text{ lösbar in } \ZZ \quad \Leftrightarrow \quad f(X) \kon 0 \modu m_i \text{ lösbar in } \ZZ \text{ für jedes } 1 \leq i \leq r \]
	Die natürliche Abbildung $\ZZ/m \rightarrow \prod_{i=1}^{r} \ZZ/m_i$ vermittelt eine Bijektion
	\[ \{\alpha \in \ZZ/m : f(\alpha) = 0\} \rightarrow \prod_{i=1}^{r} \{ \alpha_i \in \ZZ/m_i : f(\alpha_i) = 0 \} \]
	Für die Lösungsanzahlen $N_f(n) := \# \{\alpha \in \ZZ/n : f(\alpha) = 0 \}$ gilt also:
	\[N_f(m_1m_2\dots m_r) = N_f(m_1) N_f(m_2) \cdots N_f(m_r) \]
\newpage