\section{Allgemeines über Kryptographieverfahren}
\label{sec:para1}

\subsection{Grundlagen aus der elementaren Zahlentheorie und Gruppentheorie}
\subsubsection{Zahlen, Darstellung von Zahlen}
	Die Zahlbereiche $\NN \subseteq \ZZ \subseteq \QQ \subseteq \RR \subseteq \CC$ sind aus den \marginnote{[2]} Grundvorlesungen bekannt. Bezüglich den Verknüpfungen $+$ und $\cdot$ sind verschiedene Axiome erfüllt, die diese Zahlbereiche zu interessante algebraische Strukturen machen:	
\begin{center}
	\begin{tabular}{|c|c|c|c|}
	\hline  \textbf{Halbgruppe}		&	\textbf{Gruppe}								&	\textbf{Ring}			&	\textbf{Körper} \\
	\hline	$(\NN,+), (\NN,\cdot)$ & & & \\
	\hline $(\ZZ,+),(\ZZ,\cdot)$ & $(\ZZ,+,0) $ & $(\ZZ,+,\cdot)$ & \\
	\hline $(\QQ,+),(\QQ,\cdot)$ & $(\QQ,+,0),(\QQ \setminus \setnull, \cdot, 1)$ & $(\QQ,+,\cdot)$ & $(\QQ,+,\cdot)$ \\
	\hline $(\RR,+), (\RR,\cdot)$ & $(\RR,+,0), (\RR\setminus \setnull, \cdot, 1)$ & $(\RR,+,\cdot)$ & $(\RR,+,\cdot)$ \\
	\hline $(\CC,+),(\CC,\cdot)$ & $(\CC,+,0),(\CC \setminus \setnull, \cdot, 1)$ & $(\CC,+,\cdot)$ & $(\CC,+,\cdot)$ \\
	\hline
	\end{tabular} 
\end{center}
	Weiter sind $\QQ$ und $\RR$ angeordnete Körper, d.h. es gibt eine Anordnungsrelation $\leq$, die sich mit $+$ und $\cdot$ verträgt. Für $\CC$ ist eine solche Anordnung nicht mehr möglich.
	
\begin{defn}[Halbgruppe]
	Eine Menge $H \neq \emptyset$ mit Verknüpfung $*\colon H \times H \rightarrow H$ heißt \Index{Halbgruppe}, falls $*$ assoziativ ist, d.h. für alle $a,b,c \in H$ gilt $a*(b*c) = (a*b)*c$.
\end{defn}

\begin{defn}[Gruppe]
	Eine Halbgruppe $(G,*)$ heißt \Index{Gruppe}, falls es ein neutrales Element $e \in G$ gibt mit $e*g = g*e = g$ für alle $g \in G$, und falls zu jedem $g \in G$ ein inverses Element $h \in G$ existiert mit $h * g = g * h = e$. Wir schreiben auch $g^{-1}, \frac{1}{g}$ oder $-g$ für $h$.
\end{defn}

\begin{defn}[abelsche Gruppe]
	Eine Gruppe $(G,*,e)$ heißt \bet{abelsch} bzw. \bet{kommutativ}, falls für alle $a, b \in G$ gilt: $a * b = b*a$. \index{Gruppe!abelsch}
\end{defn}

\begin{defn}[Ring]
	Ein \Index{Ring} $(R,+,\cdot)$ \marginnote{Ring mit Eins} ist eine Menge $R \neq \emptyset$ und zwei Verknüpfungen $+$ und $\cdot$ so, dass $(R,+,0)$ eine Gruppe ist, $(R,\cdot,1)$ eine Halbgruppe mit neutralem Element $1$, und so, dass die Distributivgesetze gelten, d.h. $(a+b) \cdot c = a \cdot c + b \cdot c$ und $c \cdot (a+b) = c \cdot a + c \cdot b$.
\end{defn}

\begin{bem}
	Die Addition $+$ ist in einem Ring stets kommutativ. Ein Ring heißt kommutativ, wenn die Multiplikation $\cdot$ kommutativ ist. Soll der Nullring $R = \setnull$ mit $1 = 0$ ausgeschlossen werden, fordert man zusätzlich noch $1 \neq 0$ in den Ringaxiomen.
\end{bem}

\begin{defn}[Einheit, Einheitengruppe]
	Die in einem Ring $(R,+,\cdot)$ bezüglich $\cdot$ invertierbaren Elemente heißen \bet{Einheiten}. Die Menge der Einheiten in $R$ wird mit $R^*$ bezeichnet, d.h. also $R^* := \{a \in R : \exists b \in R \text{ mit } a \cdot b = b \cdot a = 1\}$. Damit ist $(R^*,\cdot,1)$ also eine Gruppe. \index{Einheit}
\end{defn}

\begin{defn}[Körper]
	Ein \Index{Körper} $(K,+,\cdot)$ ist ein kommutativer Ring mit $1 \neq 0$, für den $K^* = K \setminus \setnull$ gilt.
\end{defn}

Algebraische Strukturen dieser Art können wir auch in Teilmengen von $\ZZ$ auffinden und diese für kryptographische Anwendungen ausnutzen. Darum geht es in §\ref{sec:para1} dieser Vorlesung. Dabei wird klar, dass die Anwendungen auch -- teilweise -- in beliebigen Gruppen, Ringen und Körpern möglich sind. Die Gruppen, die durch elliptische Kurven gegeben sind, haben sich in der Praxis dann als vorteilhaft herausgestellt.

Wenn wir Teilmengen von $\ZZ$ auch praktisch untersuchen möchten, wird die Frage wichtig, wie man ganze Zahlen auf geschickte und kompakte Art darstellen kann. Dafür benutzen wir im Alltag das Dezimalsystem, für Rechenmaschinen ist auch das Binär- und das Hexadezimalsystem nützlich. Dabei werden die Ziffern $0,1,\dots 9$ bzw. $0,1$ bzw. $0,1,\dots, 9, A, \dots, F$ verwendet. Allgemein erhalten wir die $g$-adische Darstellung von $n \in \NN$ so:

\begin{satz}
\label{satz_g-adisch}
	Sei $g \in \NN, g \geq 2$ und $n \in \NN$. Dann gibt es ein $k \in \NN_0$ und $c_k, c_{k-1}, \dots, c_0 \in \{0, \dots, g-1\}$ (genannt "Ziffern"), sodass $n = c_k g^k + c_{k-1} g^{k-1} + \dots + c_0 = \sum_{i=0}^k c_i g^i$. Fordern wir $c_k \neq 0$, ist $k$ und die Folge $c_k, \dots, c_1, c_0$ eindeutig bestimmt.
\end{satz}

\minisec{Beweis}
	\begin{description}
	\item[Existenz:] Sei $k \in \NN_0$ so, dass $g^k \leq n < g^{k+1}$ gilt, das heißt wir setzen $k := \floor*{\frac{\log(n)}{\log(g)}}$. Zeige durch Induktion nach $k$ die Existenz: \\
	$k = 0$: Setze $c_0 := n$. \\
	$k \rightsquigarrow k+1$: Sei $g^{k+1} \leq n < g^{k+2}$. Setze $n' = n - \floor*{\frac{n}{g^{k+1}}} \cdot g^{k+1}$. Es folgt $0 \leq n' < g^{k+1}$, d.h. auf $n'$ ist die Induktionsvoraussetzung anwendbar. Nach dieser hat $n'$ eine $g$-adische Zifferndarstellung $n' = \sum\limits_{i=0}^{k} c_i g^i$. Wegen $1 \leq  \frac{n}{g^{k+1}} < g$ ist $1 \leq \floor*{\frac{n}{g^{k+1}}} < g$, also setze $c_{k+1} := \floor*{\frac{n}{g^{k+1}}}$. \\
	$\Rightarrow  n = c_{k+1} g^{k+1} + n' = \sum\limits_{i=0}^{k+1} c_i g^i$.
	\item[Eindeutigkeit:] Sind $\sum\limits_{i=0}^{k} a_i g^i = m = \sum\limits_{i=0}^{r} b_i g^i$ zwei verschiedene Darstellungen von $m \in \NN$. Ist $r > k$, so sei $a_{k+1} = \dots = a_r := 0$, sonst sei $b_{r+1} = \dots = b_k := 0$, falls $r < k$. Dann sei $l := \max \{i \in \NN_0 : i \leq \max\{k,r\}, a_i \neq b_i \}$ die größte Stelle, an der sich die Darstellungen unterscheiden. \\
	$\Rightarrow 0 = \sum\limits_{i=0}^l \underbrace{(a_i-b_i)}_{=0 \text{ für } i>l} g^i \Rightarrow \underbrace{|b_l - a_l|}_{\geq 1} g^l = \abs*{\sum\limits_{i=0}^{l-1} (a_i - b_i)g^i}$ \\
	$\Rightarrow g^l \leq \sum\limits_{i=0}^{l-1} |a_i-b_i| g^i \leq \sum\limits_{i=0}^{l-1} (g-1) g^i = (g-1) \frac{g^l - 1}{g-1} = g^l - 1 \quad \lightning$ \qed
	\end{description}


\begin{defn}[$g$-adische Darstellung]
	Die Ziffernfolge $c_k, c_{k-1}, \dots c_0$ aus Satz \ref{satz_g-adisch} heißt \bet{$g$-adische Darstellung} von $n$. Die Zahl $c_k$ heißt \Index{Leitziffer}, die Zahl $c_0$ die \Index{Endziffer}. Die Zahl $k+1$ heißt \Index{Stellenzahl} bzw. \textbf{Länge} der $g$-adischen Darstellung. Die Zahl $g$ heißt auch \textbf{Basis} der Darstellung. Eine \bet{$m$-Bit-Zahl} ist eine Zahl $n \in \NN$ der Länge $\leq m$ zur Basis $2$. \index{g-adische Darstellung@$g$-adische Darstellung} \index{n-Bit-Zahl@$n$-Bit-Zahl}
\end{defn}

\begin{bem}
	Wir können jede natürliche (und dann auch jede ganze) Zahl $n$ also eindeutig schreiben als Linearkombination endlich vieler Potenzen von $g$.
\end{bem}

\begin{bsp}
 \begin{equation}
 \begin{aligned}
	 163_{(10)} &= 1 \cdot 10^2 + 6 \cdot 10^1 + 3 \cdot 10^0 \\
	 43_{(10)}	&= 1 \cdot 2^5 + 0 \cdot 2^4 + 1 \cdot 2^3 + 0 \cdot 2^2 + 1 \cdot 2^1 + 1 \cdot 2^0 = 101011_{(2)} \\
	 &= 2 \cdot 16^1 + 11 \cdot 16^0 = 2B_{(16)}
 \end{aligned}
 \end{equation}
\end{bsp}

Die bekannten schriftlichen Additions- und Multiplikationsrechnungen, die unter Beachtung von Überträgen ziffernweise geschehen, können in jeder Basis ausgeführt werden. Es gibt weiter für die Multiplikation großer Zahlen (d.h. mit großer Stellenzahl bis etwa $2 \cdot 10^{10}$) schnelle Algorithmen, die wir hier aber nicht näher behandeln möchten; etwa mit der schnellen Fouriertransformation (FFT) nach Schönhage/Strassen\footnote{siehe \url{http://de.wikipedia.org/wiki/Sch\%C3\%B6nhage-Strassen-Algorithmus}}.

Der Beweis von Satz \ref{satz_g-adisch} zeigt, dass die Länge von $n$ gleich $\floor*{\frac{\log(n)}{\log(g)}}+1$ ist, so viele Ziffern müssen zum Hinschreiben bzw. Eintippen von $n$ angegeben werden. Bei verschiedenen Basen ändert sich hier nur der Faktor $\frac{1}{\log(g)}$. Deswegen sagt man, die Länge sei $\oh(\log(n))$ und meint damit die Aussage: Es existiert eine Konstante $C > 0$, sodass $k + 1 \leq C \cdot \log(n)$. (Landau-Symbolik\footnote{siehe \url{http://de.wikipedia.org/wiki/Landau-Symbole}}, "Groß-O-Notation")

Entscheidend für das Studium von $\ZZ$ ist der Grundbegriff der Teilbarkeit.
\begin{defn}[Teilbarkeit]
	Für $a,b \in \ZZ$ heißt $a$ \Index{Teiler} von $b$ bzw. $a$ \bet{teilt} $b$, in Zeichen $a \mid b$, falls ein $c \in \ZZ$ existiert mit $ac = b$. Ist $a$ kein Teiler von $b$, schreibt man $a \nmid b$.
\end{defn}

\begin{bsp}
	$3 \mid 12$, $4 \mid 0$, $0 \mid 0$, $7 \nmid 12$, $0 \nmid 4$. Es kann $0$ nur die $0$ teilen.
\end{bsp}

\begin{defn}[Primzahl]
	Eine natürliche Zahl $p \in \NN$ heißt \Index{Primzahl} bzw. \bet{prim}, wenn sie genau zwei Teiler in $\NN$ besitzt (nämlich $1$ und $p$, $1 \neq p$). Eine natürliche Zahl $n > 1$ heißt \Index{zusammengesetzt}, falls $n$ keine Primzahl ist. 
\end{defn}

Primzahlen sind die "Bausteine" der natürlichen Zahlen:
\begin{satz}[Satz von der eindeutigen Primfaktorzerlegung, Hauptsatz der Arithmetik]
	Jede natürliche Zahl $n > 1$ besitzt genau eine Darstellung
	\[ n = p_1^{e_1} \cdot p_r^{e_r} = \prod\limits_{i=1}^{r} p_i^{e_i} \]
	mit $r \in \NN$, Primzahlen $p_1, \dots, p_r$ mit $e_1,\dots,e_r \in \NN$ und $p_1 < p_2 < \dots < p_r$. Diese heißt die \Index{Primfaktorzerlegung} (PFZ) von $n$.
\end{satz}

\begin{bem}
	Lässt man die letzte Bedingung weg, ist die Darstellung eindeutig bis auf die Reihenfolge der Primpotenzen. Die Zahl $e_i$ ist dabei die Vielfachheit (auch \Index{Exponent} genannt), mit der $p_i$ als Faktor in $n$ auftritt, d.h. $p_i^{e_i} \mid n$, aber $p^{e_i+1} \nmid n$. Dafür gibt es das Symbol $p^{e_i} \parallel n$, und die Primfaktorzerlegung lässt sich kompakt auch schreiben als $n = \prod\limits_{p} p^{e(p)}$, wobei $e(p) := e$ mit $p^e \parallel n$, falls $p \mid n$, und $e(p) := 0$, falls $p \nmid n$. Weiter ist $\omega(n) := r$ die Anzahl der verschiedenen Primteiler von $n$.
\end{bem}

\minisec{Beweis}
	\begin{description}
		\item[Existenz:] Ist $n$ prim, ist nichts zu zeigen, und ist $n$ nicht prim, gibt es $k, l \in \NN \setminus \{1\}$ mit $n = kl$. Da $\min\{k,l\} > 1$, folgt $\max \{k,l\} < n$. Nach Induktionsvoraussetzung sind also $k,l$ Produkte von Potenzen von Primzahlen, also auch $n = kl$.
		\item[Eindeutigkeit:] Sei $n > 1$ minimal mit zwei verschiedenen Zerlegungen $n = \prod\limits_{i=1}^{r} p_i^{e_i} = \prod\limits_{i=1}^{s} q_i^{f_i}$, die $p_i, q_i$ prim und angeordnet. Da $p_1 \neq q_i$ für alle $i$ gilt (sonst hätte $\frac{n}{p_1} < n$ zwei verschiedene Zerlegungen), ist $\ggT(p_1,q_i) = 1$, und mit den Zerlegungen folgt $p_1 \mid q_1^{f_1 - 1}$ aus Lemma \ref{lemma_21}. Die Fortsetzung des Verfahrens zeigt schließlich $p_1 \mid q_s$, was wegen $\ggT(p_1,q_s) = 1$ ein Widerspruch ist. \qed
		(Beachte: Zum Beweis von Lemma \ref{lemma_21} wurde nie die Eindeutigkeit der Primfaktorzerlegung benutzt.)
	\end{description}

Die Eindeutigkeit der Primfaktorzerlegung zeigt, dass auch diese eine Möglichkeit zur Darstellung natürlicher Zahlen ist. Diese ist jedoch unpraktisch, weil das folgende Problem im Allgemeinen schwer zu lösen ist, worauf einige kryptographische Verfahren (insb. RSA) beruhen.

\begin{defn}[Faktorisierungsproblem]
	Zu einer natürlichen zusammengesetzten Zahl $n > 1$ bestimme man einen nichttrivialen Teiler $t$ mit $1 < t < n$.
\end{defn}

Klar: Ist das Faktorisierungsproblem rechnerisch leicht zu machen, kann auch (durch Iteration) die Primfaktorzerlegung von $n$ leicht bestimmt werden. In der Praxis, wenn $n$ nicht gerade schon von einer speziellen Form ist, können Teiler großer Zahlen $n$ jedoch nur sehr schwer aufgefunden werden.
\begin{itemize}
	\item Das derzeit schnellste algorithmische Verfahren zur Faktorisierung (auf einem klassischen Computer) ist das \Index{Zahlkörpersieb} mit einer Laufzeit von nur $\oh(\exp(C (\log n)^{1/3} (\log \log n)^{2/3}))$, d.h. es handelt sich um so genanntes \bet{subexponential schnelles Verfahren}, weil $(\log n)^B \ll \exp(C(\log n)^{1/3} (\log \log n)^{2/3}) \ll \exp(D \log n) = n^D$.
	\item Peter Shor\footnote{\url{http://de.wikipedia.org/wiki/Peter_Shor}} entdeckte um 1994, dass das Faktorisierungsproblem auf einem Quantencomputer mit einer Laufzeit von (meist) nur $\oh((\log n)^3)$ sehr (d.h. polynomiell) schnell gelöst werden kann, was die Sicherheit gängiger Kryptoverfahren wie RSA untergräbt. Allerdings ist die Konstruktion solcher Quantencomputer (physikalisch) extrem schwierig, diverse Forschergruppen arbeiten daran. Am 2.1.2014 meldete die Washington Post unter Berufung auf Dokumente von Edward Snowden\footnote{\url{http://de.wikipedia.org/wiki/Edward_Snowden}}, dass die NSA an der Entwicklung eines kryptographisch mützlichen Quantencomputers arbeitet\footnote{\href{http://www.washingtonpost.com/world/national-security/nsa-seeks-to-build-quantum-computer-that-could-crack-most-types-of-encryption/2014/01/02/8fff297e-7195-11e3-8def-a33011492df2_story.html}{Link zum Artikel}}.
	Zum Begriff Quantencomputer siehe \href{http://de.wikipedia.org/wiki/Quantencomputer}{Wikipedia}.
\end{itemize} 

Im Folgenden besprechen wir noch den ggT zweier natürlicher Zahlen, der sich in vielerlei Hinsicht als wichtig und nützlich erweist:
\begin{defn}
	Seien $a,b \in \ZZ$. Der \bet{größte gemeinsame Teiler} (ggT) von $a$ und $b$ in $\NN$ ist die Zahl $d := \max\{t \in \NN : t \mid a \wedge t \mid b\}$. Notation: $\ggT(a,b) := d$. Ist $\ggT(a,b) = 1$, heißen $a$ und $b$ \Index{teilerfremd}. \index{größter gemeinsamer Teiler}
\end{defn}
Haben wir für $a$ und $b$ die Primfaktorzerlegungen $a = \prod_p p^{e(p)}$ und $b = \prod_p p^{f(p)}$ vorliegen, kann ihr ggT leicht bestimmt werden als $\ggT(a,b) = \prod_p p^{\min(e(p),f(p))}$, z.B. $\ggT(2^3 \cdot 3^6 \cdot 5^4, 2^4 \cdot 3^5) = 2^3 \cdot 3^5$. Wegen des Faktorisierungsproblems kann dies aber so nicht praktisch umgesetzt werden. Stattdessen benutzt man den (polynomiell) schnellen euklidischen Algorithmus, vgl. Übungsaufgabe.

\begin{satz}[Teilen mit Rest]
	Zu $a \in \ZZ, b \in \NN$ existieren eindeutigen $q,r \in \ZZ, 0 \leq r < b$ mit $a = qb + r$, nämlich $q = \floor*{\frac{a}{b}} = \max\{m \in \ZZ : m \leq \frac{a}{b}\}$ und $r = a-qb$. Dabei heißt $r$ der \bet{kleinste nichtnegative Rest}. Statt $0 \leq r < b$ kann auch $r \in \ZZ$, $\abs{r} < \frac{b}{2}$, erfüllt werden; $r$ heißt dann der \bet{absolut kleinste Rest} (bei Division durch $b$). \index{Divison mit Rest} \index{kleinster nichtnegativer Rest} \index{absolut kleinster Rest}
\end{satz}

\begin{satz}[Euklidischer Algorithmus]
\label{satz_ea}
	Seien $a,b \in \NN$. Durch fortgesetztes Teilen mit Rest erhalten wir als letzten Rest $\neq 0$ den $\ggT(a,b)$, sowie $x,y \in \ZZ$ mit $\ggT(a,b) = xa + yb$ (siehe Schema). \index{Euklidischer Algorithmus}
\end{satz}

\minisec{Beschreibung des Rechenverfahrens}
	Rechnen sukzessive mit $r_{-1} := a, r_0 :=b$:
	\begin{equation}
	\begin{aligned}
		r_{-1} &= q_0 r_0 + r_1 \\
		r_0 &= q_1 r_1 + r_2 \\
		r_1 &= q_2 r_2 + r_3 \\
		&\vdots
	\end{aligned}
	\end{equation}
	Das Verfahren wird fortgeführt, bis erstmals ein Rest $r_{m+1} = 0$ auftritt, was wegen $r_0 > r_1 > r_2 > \dots$ nach höchstens $b + 1$ vielen Schritten der Fall sein wird. Sind die Quotienten $q_0, \dots, q_m$ bekannt, können mit den Rekursionen \[
	\begin{array}{c}
		c_{-2} = 0, c_{-1} = 1 \text{ und } c_k = q_k c_{k-1} + c_{k-2}, k=0,1,2, \dots, n \\
		d_{-2} = 1, d_{-1} = 0 \text{ und } d_k = q_k d_{k-1} + d_{k-2}, k=0,1,2, \dots, n
	\end{array} \]
	die \bet{Bézout-Elemente} als $x = (-1)^{n-1}, y=(-1)^n c_{n-1}$ berechnet werden.
	
	Wir behaupten also: \begin{enumerate}[(1)]
		\item Es ist $\ggT(a,b) = r_n$.
		\item $\ggT(a,b) = \underbrace{(-1)^{n-1} d_{n-1}}_{x} a + \underbrace{(-1)^n c_{n-1}}_{y} b$
	\end{enumerate}

\minisec{Beweis}
	\begin{description}
		\item[zu (1)]: Da $r_n \mid r_{n-1}, r_n \mid r_{n-2}, \dots, r_n \mid r_0 = b, r_n \mid r_{-1} = a$, ist $r_n$ ein Teiler von $a$ und $b$ (Teilen mit Rest von unten nach oben). Ist $d$ irgendein Teiler $\geq 1$ von $a$ und $b$, folgt $d \mid r_1 = a -q_0 b \Rightarrow d \mid r_2 = r_0 - q_1 r_1 \Rightarrow d \mid r_3 = \dots$, also auch $r_n$, sodass $d \leq r_n$ folgt (Teilen mit Rest von oben nach unten). Somit ist $r_n = \ggT(a,b)$.
		\item[zu (2)]: Induktiv kann $c_{k-1} d_k - c_k d_{k-1} = (-1)^k$ gezeigt werden. Daher genügt zu zeigen: $c_n = \frac{a}{\ggT(a,b)}, d_n = \frac{b}{\ggT(a,b)}$. \marginnote{Details siehe EZT-Skript Lorenz} \\
		\textcolor{gray}{Mit den $\frac{c_k}{d_k}$ wird die Kettenbruchentwicklung von $\frac{a}{b}$ berechnet und diese bricht bei $\frac{c_n}{d_n} = \frac{a}{b}$ ab. Da bei der Kettenbruchentwicklung alle Brüche $\frac{c_k}{d_k}$ gekürzt sind wegen $c_{k-1} d_k - c_k d_{k-1} = (-1)^k$, folgt dies.} 
	\end{description}
	
Der Satz vom Euklidischen Algorithmus sichert uns konstruktiv also die Existenz ganzer Zahlen $x,y \in \ZZ$ mit $\ggT(a,b) = xa + yb$. Die Zahlen $x$ und $y$ heißen auch \Index{Bézout-Elemente} von $a$ und $b$. Deren Existenz ist auch in der Theorie immer wieder wichtig, z.B. hierfür:

\begin{lemma}
\label{lemma_21}
	Seien $a,b,c \in \ZZ$ und $b,c \neq 0$. Gilt $c \mid ab$ und $\ggT(b,c) = 1$, dann ist $c \mid a$.
\end{lemma}

\minisec{Beweis}
	Aus den Voraussetzungen und $c \mid ac$ folgt, dass $c \mid \ggT(ab,ac) = |a| \cdot \ggT(b,c) = |a|$, also $c \mid a$. Zur ersten Gleichheit: Nach Satz \ref{satz_ea} existieren $x,y \in \ZZ$ mit $\ggT(b,c) = xb + yc$. \\
	$|a| \cdot \ggT(b,c)$ teilt $|a|\cdot b$ und $|a| \cdot c$, also auch $ba$ und $ca$, d.h. die rechte Seite ist ein gemeinsamer Teiler von $ba$ und $ca$. Ist $t$ irgendein solcher, so teilt $t$ auch $\sgn(a) \cdot(xba + yca) = xb \cdot |a| + yc \cdot |a| = |a| \cdot (xb + yc) = |a| \ggT(b,c)$. \qed
	
\subsubsection{Kongruenzenrechnen und die modulare Brille}
	Wir behandeln nun, wie man mit Teilmengen von $\ZZ$ und neuen Definitionen von "$+$" und "$\cdot$" zu neuen algebraischen Strukturen (Gruppe, Ringe, Körper) kommt. Dazu ist das Kongruenzenrechnen modulo $m$ wesentlich.
	
\begin{defn}[Kongruenz, Modul]
	Sei $m \in \NN$. Dann heißen $a \in \ZZ$ und $b \in \ZZ$ \bet{kongruent modulo $m$}, wenn $m \mid (b-a)$. Wir schreiben dann $a \kon b \modu m$ oder $a \kon b \ (m)$. Die Zahl $m$ heißt der \Index{Modul} der Kongruenz. \index{Kongruenz}
\end{defn}

\begin{folg}
\label{folg_1.1.2.2}
	\begin{enumerate}[(1)]
		\item $a \kon b \modu m$ bedeutet, dass $a$ und $b$ bei Division durch $m$ denselben kleinsten nichtnegativen (absolut kleinsten) Rest lassen.
		\item $a \kon b \modu m, b \kon c \modu m \Rightarrow a \kon c \modu m$
		\item $a_1 \kon b_1 \modu m, a_2 \kon b_2 \modu m \Rightarrow a_1 + a_2 \kon b_1 + b_2 \modu m, a_1 \cdot a_2 \kon b_1 \cdot b_2 \modu m$.
		\item $ca \kon cb \modu m \Rightarrow a \kon b \modu \enbrace*{\frac{m}{\ggT(c,m)}}$, insbesondere $a \kon b \modu m$, falls $\ggT(c,m) = 1$.
		\item $a \kon b \modu m_i$ für $i = 1, \dots, k \Rightarrow a \kon b \modu \kgV(m_1,\dots,m_k)$
	\end{enumerate}
	Dies zeigt, dass $\kon$ für festes $m$ eine Äquivalenzrelation ist und $\ZZ$ in $m$ paarweise disjunkte Äquivalenzklassen zerlegt.
\end{folg}

\begin{defn}[Restklasse]
	Die Äquivalenzklassen von $\kon$ modulo $m$ heißen \bet{Restklassen} modulo $m$. (auch: Kongruenzklassen modulo $m$). \index{Restklasse}
\end{defn}

\begin{folg}
	Die Restklassen modulo $m$ sind Teilmengen von $\ZZ$ der Gestalt $x + m\ZZ := \{x + ma : a \in \ZZ\}$. Die Restklasse $x + m\ZZ$ heißt auch die Restklasse von $x$ modulo $m$. Davon gibt es $m$ Stück; wird in jeder Restklasse ein Element $x_i$, $i = 1, \dots, m$ ausgewählt, können die $m$ Restklassen mit $x_1 + m\ZZ, x_2 + m\ZZ, \dots, x_m + m\ZZ$ angegeben werden; die Menge $\{x_1,\dots,x_m\}$ heißt dann \bet{vollständiges Restsystem} modulo $m$. Sind $y_1, \dots, y_m \in \ZZ$ so, dass $y_i \not\kon y_j \modu m$ für alle $i \neq j$, $1 \leq i,j \leq m$, gilt (d.h. die $y_i$ sind paarweise inkongruent modulo $m$), dann ist $\{y_1, \dots, y_m\}$ ein vollständiges Restsystem modulo $m$. Die Zahl $x$ heißt \Index{Repräsentant} der Restklasse $x + m\ZZ$, und $x + m\ZZ = z + m\ZZ \Leftrightarrow x \kon z \modu m$, weil laut Definition in der Restklasse von $x \mod m$ genau alle zu $x$ kongruenten Zahlen liegen. \index{Restsystem!vollständig}
\end{folg}

\begin{bsp}
	$\{0,1,2\}$ ist vollständiges Restsystem modulo $3$, und vollständige Restsysteme modulo $8$ sind etwa $\{1,\dots,8\}$ und $\{3,6,9,12,15,18,21,24\} = \{3a : 1 \leq a \leq 8\}$, da $12 \kon 4 \modu 8, 15 \kon 7 \modu 8, 18 \kon 2 \modu 8, 21 \kon 5 \modu 8, 24 \kon 0 \modu 8$. Die Menge $\{2a : 1 \leq a \leq 8\}$ ist kein vollständiges Restsystem modulo $8$. Die Reste $0,1,\dots,m-1$ könnte man auch als "Standardrepräsentanten" modulo $m$ bezeichnen, da sie immer ein vollständiges Restsystem modulo $m$ bilden.
\end{bsp}

\begin{folg}
	Ist $\{x_1,\dots,x_m\}$ ein vollständiges Restsystem modulo $m$ und $a \in \ZZ,  c\in \ZZ$ mit $\ggT(c,m) = 1$, so sind auch $\{x_1 + a, x_m + a\}$ und $\{x_1 \cdot c, \dots, x_m \cdot c\}$ vollständige Restsysteme modulo $m$ (vgl. (4) aus Folgerung \ref{folg_1.1.2.2}).
\end{folg}

Das nützliche an den Restklassen modulo $m$ ist, dass wir nun durch folgende naheliegende Definitionen von $\oplus$ und $\odot$ mit ihnen neue algebraische Strukturen gewinnen können:
\begin{defn}[Addition und Multiplikation auf $\ZZ_m$]
	Ist der Modul $m$ klar, schreiben wir auch $\uline{x} := x+m\ZZ$ für die Restklasse von $x$ modulo $m$. Wir definieren für $x,y \in \ZZ$ dann
	\begin{equation}
	\begin{aligned}
		\uline{x} \oplus \uline{y} &:= \uline{x+y} \\
		\uline{x} \odot \uline{y} &:= \uline{x \cdot y}
	\end{aligned}
	\end{equation}
	Weiter sei $\ZZ_m = \ZZ/m\ZZ = \ZZ/m := \{x + m\ZZ : x \in \ZZ\}$ die Menge der $m$ vielen Restklassen modulo $m$.
\end{defn}

\begin{folg}
	Wir addieren bzw. multiplizieren zwei Restklassen, indem wir Repräsentanten $x,y$ auswählen und diese addieren bzw. multiplizieren. Das ist nur sinnvoll, wenn bei unterschiedlicher Repräsentantenwahl dieselbe Restklasse als Ergebnis herauskommt. Man sagt, die Definition von $\oplus$ und $\odot$ ist wohldefiniert, da repräsentantenunabhängig. Dies ist klar: $\uline{x_1} = \uline{x_2}$ und $\uline{y_1} = \uline{y_2} \Rightarrow x_1 \kon x_2 \modu m$ und $y_1 \kon y_2 \modu m \Rightarrow x_1 + y_1 \kon x_2 +y_2 \modu m \Rightarrow \uline{x_1+y_1} = \uline{x_2 + y_2}$, also erhalten wir so dieselbe Restklasse für $\uline{x_1} \oplus \uline{y_1}$ und $\uline{x_2} \oplus \uline{y_2}$, wenn $\uline{x_1} = \uline{x_2}$ und $\uline{y_1} = \uline{y_2}$ (analog für die Multiplikation). Damit kann $(\ZZ_m,\oplus)$ oder $(\ZZ/m,\odot)$ auf algebraische Strukturen hin untersucht werden. Wir schreiben ab jetzt auch $+$ für $\oplus$ und $\cdot$ für $\odot$.
\end{folg}

\begin{folg}
	$(\ZZ_m,+)$ ist eine abelsche Gruppe mit neutralem Element $\uline{0} = 0 + m\ZZ$, denn Kommutativität und Assoziativität gelten wie in $\ZZ$, und $\uline{0} + \uline{x} = \uline{0+x} = \uline{x}$ gilt für alle $x \in \ZZ$, sowie $\uline{x} + \uline{-x} = \uline{x-x} = \uline{0}$, sodass $-\uline{x} = \uline{-x} = \uline{m-x}$ für alle $x \in \ZZ$ gilt. Ebenso gilt, dass $(\ZZ_m,+,\cdot)$ ein kommutativer Ring mit $1$ ist.
\end{folg}

Das Beispiel $\uline{2} \cdot \uline{0} = \uline{0}, \uline{2} \cdot \uline{1} = \uline{2}, \uline{2} \cdot \uline{2} = \uline{0}$ modulo $4$ zeigt, dass es Restklassen ohne Inversen bezüglich $\cdot$ geben kann. Der folgende Satz gibt an, welche Restklassen invertierbar sind, d.h. im Ring $\ZZ_m$ eine Einheit sind:

\begin{satz}[Einheiten in $\ZZ_m$]
	Zu $\uline{x} \in \ZZ_m$ existiert genau dann ein multiplikatives Inverses, d.h. ein $\uline{y} \in \ZZ_m$ mit $\uline{x} \cdot \uline{y} = \uline{1} \Leftrightarrow x \cdot y \kon 1 \modu m$, falls $\ggT(x,m) = 1$. Wir schreiben dann $\uline{x}^{-1}$ oder $\uline{x}^*$ für $\uline{y}$, die Bezeichnungen $\uline{\frac{1}{x}}$ oder $1/\uline{x}$ sind didaktisch ungeschickt.
\end{satz}

\minisec{Beweis}
	\begin{description}
		\item["$\Rightarrow$":] Sei $\uline{y} \in \ZZ_m$ mit $\uline{x} \cdot \uline{y} = 1$, d.h. $xy \kon 1 \modu m$, also existiert $k \in \ZZ$ mit $1 - xy = km \Rightarrow xy + km = 1$. Wäre $d = \ggT(x,m) > 1$, so folgt $d \mid xy + km = 1 \lightning$.
		\item["$\Leftarrow$":] Sei $\ggT(x,m) = 1$. Nach Satz \ref{satz_ea} existiert $y,k \in \ZZ$ mit $1 = yx + km$, also folgt $\uline{x} \cdot \uline{y} = 1$. \qed
	\end{description}

Fazit: Mit dem euklidischen Algorithmus können wir also Inverse schnell explizit berechnen.

\begin{defn}[Prime Reste, Eulersche $\varphi$-Funktion]
	$\uline{x} = x + m\ZZ$ heißt \bet{prime} oder \bet{reduzierte Restklasse} modulo $m$, falls $\ggT(x,m) = 1$ gilt. Diese sind genau die Einheiten in $(\ZZ_m,+,\cdot)$, d.h.
	\[ \ZZ_m^* = \{\uline{x} \in \ZZ_m : \ggT(x,m) = 1\} \]
	Die Anzahl der Einheiten sei $\varphi(m) := \# \ZZ_m^* = \# \{a \in \NN : a \leq m, \ggT(a,m) = 1\}$, die so erklärte Funktion $\varphi\colon \NN \rightarrow \NN$ heißt \Index{Eulersche $\varphi$-Funktion}. Jedes Repräsentantensystem $\{x_1, \dots, x_{\varphi(m)}\}$ von $\ZZ_m^*$ heißt \bet{reduziertes} oder \bet{primes Restsystem} modulo $m$.´\index{Restsystem!reduziert, prim} \index{Restklasse!reduziert, prim}
\end{defn}

\begin{satz}[Multiplikativität von $\varphi$]
\label{satz_1.1.2.12}
	Es ist $\varphi(p^k) = p^k - p^{k-1}$ für alle $p$ prim, alle $k \in \NN$, und $\varphi(mn) = \varphi(m) \cdot \varphi(n)$, falls $\ggT(m,n) = 1$.
\end{satz}

\minisec{Beweis}
	Unter den Zahlen $1,2, \dots, p^k$ sind genau die Vielfachen von $p$ zu $p^k$ nicht teilerfremd, d.h. $p, 2p, \dots, p^{k-1} \cdot p$, was $p^{k-1}$-viele Zahlen sind. Zur Multiplikativität siehe Zusatz \ref{zusatz_1.1.2.18}.
	
Ist $n = \prod_{p \mid n} p^{e(p)}$ die Primfaktorzerlegung von $n$, folgt aus Satz \ref{satz_1.1.2.12}:
\[ \varphi(n) = \prod_{p \mid n} \enbrace*{p^{e(p)} - p^{e(p)-1}} = \prod_{p \mid n} p^{e(p)} \cdot \enbrace*{1-\frac{1}{p}} = n \cdot \prod_{p \mid n} \enbrace*{1-\frac{1}{p}} \]

\begin{folg}
	$(\ZZ_m^*,\cdot)$ ist eine Gruppe, die multiplikative Gruppe von $\ZZ_m$, und die Gruppe $(\ZZ_m,+)$ heißt additive Gruppe von $\ZZ_m$. Im Fall $\ZZ_m^* = \ZZ_m \setminus \setnull$ ist $(\ZZ_m,+,\cdot)$ ein Körper; dies ist genau dann richtig, wenn $m = p$ Primzahl ist, weil genau dann alle $1,2, \dots, m-1$ zu $m$ teilerfremd sind. Wir bezeichnen für $p$ prim diesen Körper mit $p$ Elementen mit $\FF_p$. \marginnote{Weitere endliche Körper später} Der Körper $\FF_p$ hat die Eigenschaft, dass $p \cdot a := \sum_{i=1}^{p} a = 0$ in $\FF_p$ für alle $a \in \FF_p$ gilt. Wir sagen, er hat die Charakteristik $p$.
\end{folg}

\begin{defn}[Charakteristik]
	Sei $k$ ein Körper. Er hat die \Index{Charakteristik} $0$, falls für alle $m \in \NN$ gilt: $m \cdot 1 := \underbrace{1 + \dots + 1}_{m\text{-mal}} \neq 0$. \\
	Falls es ein $m \in \NN$ mit $m \cdot 1 = 0$ gibt, so heißt das kleinste solche $m \in \NN$ die Charakteristik von $k$. Wir schreiben kurz $\Char(k) = 0$ bzw. $\Char(k) = m$. \\
	Zum Beispiel ist $\Char(\QQ) = \Char(\RR) = \Char(\CC) = 0$ und $\Char(\FF_p) = p$.
\end{defn}

\minisec{Bemerkung}
	Die Charakteristik eines Körpers $k$ ist entweder $0$ oder eine Primzahl, denn sonst wäre $0 = (m\cdot n) \cdot 1 = m \cdot (n \cdot 1) = (m \cdot 1) \cdot (n \cdot 1) \Rightarrow m \cdot 1 = 0$ oder $n \cdot 1 = 0$, da $k^* = k \setminus \setnull$. Widerspruch zu $m\cdot n$ minimal.

Die Struktur der Zahlringe $(\ZZ_m,+,\cdot)$ versteht man besser, indem man sie auf "kleinere" Zahlringe zurückführt:

\begin{satz}[Chinesischer Restsatz für Zahlringe]
\label{satz_1.1.2.15}
	Sei $m > 1$ eine natürliche Zahl und $m = m_1 \cdot m_2 \cdot \dots \cdot m_r$ eine Zerlegung von $m$ in paarweise teilerfremde Zahlen $m_i > 1$. Dann ist die Abbildung
	\begin{equation}
	\begin{aligned}
		F\colon \ZZ/m\ZZ &\longrightarrow (\ZZ/m_1\ZZ) \times \dots \times (\ZZ/m_r \ZZ) \\
		x + m\ZZ &\longmapsto (x + m_1\ZZ, \dots x + m_r \ZZ)
	\end{aligned}
	\end{equation}
	ein Isomorphismus von Ringen. \index{Chinesischer Restsatz}
\end{satz}

\begin{satz}[Chinesischer Restsatz für simultane Kongruenzen]
\label{satz_1.1.2.16}
	Seien $m_1, \dots, m_r > 1$ paarweise teilerfremde Zahlen und sei $a_1, \dots, a_r \in \ZZ$. Dann ist das simultane Kongruenzensystem
	\begin{equation}
	\begin{aligned}
		x &\kon a_1 \modu m_1 \\
		x &\kon a_2 \modu m_2 \\
		&\vdots \\
		x &\kon a_r \modu m_r
	\end{aligned}
	\end{equation}
	in $x$ lösbar, die Lösungen sind alle kongruent modulo $m_1 \cdots m_r$.
\end{satz}

\minisec{Bemerkung}
	Satz \ref{satz_1.1.2.16} folgt aus \ref{satz_1.1.2.15} wegen der Bijektivität von $F$, denn $(a_1+m_1\ZZ, \dots, a_r+m_r\ZZ)$ hat dann genau ein Urbild $x + m\ZZ$.
	
\begin{zusatz}[zu Satz \ref{satz_1.1.2.16}]
\label{zusatz_1.1.2.17}
	Genau alle $x \kon x_0 \modu m_1 \cdots m_r$ lösen das oben angegebene System, wobei $x_0 = a_1 M_1^* M_1 + \dots + a_r M_r^* M_r$ mit $M_i := \frac{m_1 \cdots m_r}{m_i}$ und $M_i^* \in \ZZ$ ein multiplikatives Inverses von $M_i \mod m_i$ repräsentiert, d.h. es gilt $M_i^* \cdot M_i \kon 1 \modu m_i$, wobei die $M_i^*$ mit dem euklidischen Algorithmus (schnell) berechnet werden können.
\end{zusatz}

\begin{zusatz}[zu Satz \ref{satz_1.1.2.15}]
\label{zusatz_1.1.2.18}
	Die Gruppe $\ZZ_m^*$ ist isomorph zu $\ZZ_{m_1}^* \times \dots \times \ZZ_{m_r}^*$, beide Gruppen haben dann gleich viele Elemente, es folgt
	\[ \varphi(m) = \varphi(m_1) \cdot \varphi(m_2) \cdots \varphi(m_r), \]
	d.h. die Multiplikativität von $\varphi$ ist ein Korollar des chinesischen Restsatzes.
\end{zusatz}

\minisec{Beweis von Satz \ref{satz_1.1.2.16}}
	\begin{description}
		\item[Existenz:] Ist $x \kon x_0 \modu m_1 \cdots m_r$, wie in Zusatz \ref{zusatz_1.1.2.17} angegeben, so folgt für alle $1 \leq i \leq r$:
		\[ x \kon x_0 = \underbrace{a_1 M_1^* M_1}_{\kon 0 \modu m_i} + \dots + \underbrace{a_i M_i^* M_i}_{\kon a_i \cdot 1 \modu m_i} + \dots + \underbrace{a_r M_r^* M_r}_{\kon 0 \modu m_i} \kon a_i \modu m_i \]
		\item[Eindeutigkeit modulo $m_1 \cdots m_r$:] Ist $y \in \ZZ$ eine weitere Lösung des Kongruenzensystems, so gilt für alle $j \neq i$: $y \kon a_j \modu m_j$, also $\underbrace{M_j^* \cdot M_j}_{\kon 1 \modu m_j} \cdot y \kon a_j \modu m_j$ und $M_i M_i^* a_i \kon 0 \modu m_j$ (Division durch $m_j$), und somit
		\[ y \kon a_j \modu m_j \kon \sum_{j=1}^{k} M_j M_j^* a_j \modu m_j \kon x_0 \modu m_j \text{ für alle } j=1,\dots,r. \]
		Damit folgt, dass $m_j$ Teiler von $y-x_0$ ist. Da die $m_1, \dots, m_r$ alle paarweise teilerfremd sind, folgt daraus $y \kon x_0 \modu m_1 \cdots m_r$, vgl. \ref{folg_1.1.2.2} (5). \qed
	\end{description}
	
\minisec{Beispiel zum chinesischen Restsatz}
	Das System
	\begin{equation}
	\begin{aligned}
		x \kon 2 \modu 7 \\
		x \kon 3 \modu 8
	\end{aligned}
	\end{equation}
	hat die Lösung $x \kon 2 \cdot 1 \cdot 8 + 3 \cdot (-1) \cdot 7 = -5 \kon 51 \modu 56$, denn $1 \kon 8^{-1} \modu 7$ und $-1 \kon 7^{-1} \modu 8$.
	
	Beispiel-Textaufgabe dazu: Gegeben seien zwei Tüten mit gleich vielen Bonbons. Beim gleichmäßigen Aufteilen der einen Tüte an sieben Kinder bleiben zwei Bonbons übrig. Beim Aufteilen der anderen auf acht Kinder bleiben drei Bonbons übrig. Wie viele Bonbons waren in einer Tüte? \\
	Lösung: Möglich sind 51, 107, 163, \dots Stück. 
	
\minisec{Beispiele zum Rechnen mit Kongruenzen}
	\begin{itemize}
		\item Es ist $5x \kon 4 \modu 12 \Leftrightarrow 5^{-1} \cdot 5x \kon 4 \cdot 5^{-1} \modu 12 \Leftrightarrow x \kon 4 \cdot 5^{-1} \kon 4 \cdot 5 = 20 \kon 8 \modu 12$. \\
		Analog rechnet man in der Restklasse modulo $12$: \\
		$5x \cdot 4 \Leftrightarrow x = 5^{-1} \cdot 4 = 4 \cdot 5 = 20 = 8$.
		\item Es ist
		\begin{equation}
		\begin{aligned}
			8x^2 - 2x + 3 &\kon -1 \modu 7 \\
			\Leftrightarrow \quad (x-1)^2 - 2 +3 &\kon -1 \modu 7 \\
			\Leftrightarrow \quad (x-1)^2 &\kon -2 \kon 5 \modu 7
		\end{aligned}
		\end{equation}
		Da nun wegen $0^2 \kon 0 \modu 7, 1^2 \kon 1 \modu 7, 2^2 \kon 4 \modu 7, 3^2 \kon 2 \modu 7$ die Zahl $5$ kein Quadrat modulo $7$ ist, hat die Kongruenz keine Lösung. \marginnote{man spricht auch von quadratischen Resten modulo $7$} \\
		Die Kongruenz $(x-1)^2 \kon 4 \modu 7$ hat die beiden Lösungen $x \kon 3 \modu 7$ und $x \kon -1 \modu 7$.
		\item Die Kongruenz $(x-3) \cdot 4 \kon 1 \modu 33$ ist schreibbar als System:
		\begin{equation}
		\begin{aligned}
			(x-3) \cdot 4 &\kon 1 \modu 3 \\
			(x-3) \cdot 4 &\kon 1 \modu 11
		\end{aligned}
		\end{equation}
		Die beiden einzelnen Kongruenzen haben die Lösungen $x \kon 1 \modu 3$ sowie $x \kon 6 \modu 11$. Mittels chinesischem Restsatz erhält man eine Lösung der Ausgangskongruenz modulo $33$: \\
		$x \kon 1 \cdot 2 \cdot 11 + 6 \cdot 4 \cdot 3 = 22 + 6 \cdot 12 = 94 \kon -5 \kon 28 \modu 33$
		\item Bei manchen zahlentheoretischen Aufgaben, wie z.B. die Frage, ob es ganzzahlige Lösungen zu bestimmten Gleichungen geben kann, ist die "modulare Brille" ein nützliches Hilfsmittel. Hier ein Beispiel, wo wir die modulare Brille modulo $8$ aufsetzen, um mehr zu sehen: \\
		Betrachte die Gleichung $8x + 7 = u^2 + v^2 + w^2$ in $u,v,w,x \in \NN_0$. Sie ist unlösbar, denn modulo $8$ erhalten wir $7 \kon u^2 + v^2 + w^2 \modu 8$. Alle quadratischen Reste modulo $8$ sind $0, 1$ und $4$:
		\begin{center}
			\begin{tabular}{c||c|c|c|c|c}
			$z$ & $0$ & $\pm 1$ & $\pm 2$ & $\pm 3$ & $4$ \\ 
			\hline $z^2$ & $0$ & $1$ & $4$ & $1$ & $0$ \\ 
			\end{tabular} 
		\end{center}
		Daher ist $v^2 + w^2 \kon 0,1,4,2,5 \modu 8$, also $u^2+v^2+w^2 \kon 0,1,4,2,5, \quad 1,2,5,3,6, \quad 4,5,0,6,1 \modu 8$, aber nie $\kon 7 \modu 8$. Es kann keine Lösungen modulo $8$ geben, also auch keine in $\ZZ$.
	\end{itemize}
	